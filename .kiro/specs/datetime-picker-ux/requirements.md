# Requirements Document

## Project Description (Input)
日付・時刻ピッカーのUIUX改善

### 背景

予定編集の際の開始日時、終了日時の日付時刻選択が現状のカラースキームと合わず、浮いている。

予定の時刻選択はサービスの本質機能と密接に関わる部分のため、快適なUIを追求する必要がある。

### 目的

日付・時刻ピッカーのデザインとUXを改善し、デスクトップ・モバイル両方で快適に日時入力できるようにする。

### 受け入れ条件

- 日付ピッカーのカラースキームが既存のデザインシステム（shadcn/ui）と統一されている
- 時刻ピッカーのカラースキームが既存のデザインシステムと統一されている
- 時刻選択のステップが5分単位に変更されている
- モバイル端末で日付・時刻ピッカーが操作しやすいサイズで表示される
- モバイル端末向けの日付・時刻ピッカーの実装方式が調査・選定されている

### 技術メモ

- 現在の日付ピッカー: shadcn/ui Calendar コンポーネント使用
- 時刻選択: 現状1分単位 → 5分単位に変更
- モバイル対応: レスポンシブレイアウトの見直し、タップターゲットサイズの確保（最低44x44px）
- 候補ライブラリの調査が必要（ネイティブinput[type=time]、カスタムドラムロールUI等）

## Introduction

予定編集フォーム（EventForm）の日付・時刻入力を、ネイティブHTML5入力（`<input type="datetime-local">`）からshadcn/uiデザインシステムに統合されたカスタムピッカーに置き換える。デスクトップとモバイルの両方で快適な操作性を実現し、時刻選択のステップを5分単位にすることで実用的な粒度に調整する。

## Requirements

### Requirement 1: 日付ピッカーのデザインシステム統合

**Objective:** ユーザーとして、日付選択がアプリケーション全体のデザインと統一された見た目であってほしい。視覚的な一貫性が操作への信頼感を高めるため。

#### Acceptance Criteria
1. When ユーザーが日付入力フィールドをクリックする, the 日付ピッカー shall shadcn/uiのカラースキーム（`--primary`, `--background`, `--border`, `--accent` 等のCSS変数）を使用したカレンダーUIをポップオーバーで表示する
2. When ユーザーがカレンダー上の日付を選択する, the 日付ピッカー shall 選択された日付をフィールドに反映し、ポップオーバーを閉じる
3. The 日付ピッカー shall 現在の選択日をプライマリカラー（`--primary`）でハイライト表示する
4. The 日付ピッカー shall 今日の日付を視覚的に区別可能な状態（リングやドット等）で表示する
5. While ダークモードが有効な場合, the 日付ピッカー shall ダークモードのカラースキームに自動的に切り替わる

### Requirement 2: 時刻ピッカーのデザインシステム統合

**Objective:** ユーザーとして、時刻選択がアプリケーションのデザインと統一されており、5分単位で素早く選べるようにしたい。1分単位は細かすぎて操作に手間取るため。

#### Acceptance Criteria
1. When ユーザーが時刻入力フィールドをクリックする, the 時刻ピッカー shall shadcn/uiのカラースキームを使用した時刻選択UIを表示する
2. The 時刻ピッカー shall 時刻の選択肢を5分刻み（00, 05, 10, ... , 55）で提供する
3. When ユーザーが時刻を選択する, the 時刻ピッカー shall 選択された時刻をフィールドに反映する
4. The 時刻ピッカー shall 時間（0-23）と分（00-55、5分刻み）を個別に選択可能なUIを提供する
5. While ダークモードが有効な場合, the 時刻ピッカー shall ダークモードのカラースキームに自動的に切り替わる

### Requirement 3: 日時入力の統合体験

**Objective:** ユーザーとして、開始日時と終了日時の入力が直感的に連携し、矛盾のない日時設定をスムーズに行いたい。

#### Acceptance Criteria
1. When ユーザーが開始日を変更し、終了日が開始日より前になる場合, the イベントフォーム shall 終了日を開始日と同日に自動調整する
2. When ユーザーが「終日」トグルをオンにする, the イベントフォーム shall 時刻ピッカーを非表示にし、日付のみの入力に切り替える
3. When ユーザーが「終日」トグルをオフにする, the イベントフォーム shall 時刻ピッカーを表示し、日時入力に切り替える
4. The イベントフォーム shall 日付と時刻のピッカーを明確に区別可能なレイアウトで表示する

### Requirement 4: モバイル端末での操作性

**Objective:** モバイルユーザーとして、小さな画面でも日付・時刻を快適に選択したい。現状は横並びでボタンが小さく押しにくいため。

#### Acceptance Criteria
1. While 画面幅がモバイルサイズ（640px未満）の場合, the 日付・時刻ピッカー shall すべてのタップターゲットを最低44x44pxで表示する
2. While 画面幅がモバイルサイズの場合, the イベントフォーム shall 日付と時刻の入力フィールドを縦並び（スタック）レイアウトで表示する
3. While 画面幅がデスクトップサイズ（640px以上）の場合, the イベントフォーム shall 日付と時刻の入力フィールドを横並びレイアウトで表示する
4. The 日付・時刻ピッカー shall タッチ操作でスクロール・スワイプによる値の選択が可能である

### Requirement 5: アクセシビリティとキーボード操作

**Objective:** すべてのユーザーが、支援技術やキーボードを使っても日時を問題なく選択できるようにしたい。

#### Acceptance Criteria
1. The 日付ピッカー shall キーボードの矢印キーで日付間を移動可能である
2. The 時刻ピッカー shall キーボードの上下矢印キーで時刻の値を増減可能である
3. The 日付・時刻ピッカー shall 適切なARIAラベル（`aria-label`または`aria-labelledby`）を持つ
4. When ユーザーがEscキーを押す, the ピッカー shall 開いているポップオーバーを閉じ、トリガー要素にフォーカスを戻す
