# Requirements Document

## Introduction
本ドキュメントは、DiscalendarのWebアプリケーションにおけるカレンダー表示機能の要件を定義する。ユーザーがダッシュボード上でギルド（Discordサーバー）のイベントをGoogleカレンダー風のUIで視覚的に把握できるようにすることを目的とする。本Specでは表示機能に特化し、イベント編集やドラッグ&ドロップによる予定変更は別Specで対応予定。

**スコープ外（別Specで対応）:**
- イベントの作成・編集・削除
- ドラッグ&ドロップによる予定変更
- 複数日にまたがるイベントの連続表示

## Requirements

### Requirement 1: カレンダービューの表示モード切り替え
**Objective:** ユーザーとして、日/週/月のビューを自由に切り替えたい。予定の密度や時間軸に応じて最適な表示形式を選択し、効率的にスケジュールを把握できるようにしたい。

#### Acceptance Criteria
1. When ユーザーがビュー切り替えコントロールで「日」を選択する, the カレンダーコンポーネント shall 選択された1日分の時間軸を縦方向に表示する
2. When ユーザーがビュー切り替えコントロールで「週」を選択する, the カレンダーコンポーネント shall 選択された週の7日間を横方向に並べ、時間軸を縦方向に表示する
3. When ユーザーがビュー切り替えコントロールで「月」を選択する, the カレンダーコンポーネント shall 選択された月のカレンダーグリッドを表示する
4. The カレンダーコンポーネント shall デフォルトで月ビューを表示する
5. When ビューモードが切り替わる, the カレンダーコンポーネント shall 現在選択中の日付を維持したままビューを更新する

### Requirement 2: 日付ナビゲーション
**Objective:** ユーザーとして、表示する期間を前後に移動したり、特定の日付に素早くジャンプしたい。過去や未来の予定を簡単に確認できるようにしたい。

#### Acceptance Criteria
1. When ユーザーが「前へ」ボタンをクリックする, the カレンダーコンポーネント shall 現在のビューモードに応じて1日/1週間/1ヶ月前の期間を表示する
2. When ユーザーが「次へ」ボタンをクリックする, the カレンダーコンポーネント shall 現在のビューモードに応じて1日/1週間/1ヶ月後の期間を表示する
3. When ユーザーが「今日」ボタンをクリックする, the カレンダーコンポーネント shall 本日を含む期間を表示し、本日の日付をハイライトする
4. The カレンダーコンポーネント shall 現在表示中の期間（年月や日付範囲）をヘッダーに表示する
5. When 月ビューで表示月外の日付セルが存在する, the カレンダーコンポーネント shall それらのセルを視覚的に区別して表示する

### Requirement 3: イベントのカレンダーグリッド表示
**Objective:** ユーザーとして、ギルドのイベントがカレンダー上の適切な位置に表示されることで、予定の日時と期間を視覚的に把握したい。

#### Acceptance Criteria
1. When カレンダーがロードされる, the カレンダーコンポーネント shall 選択中のギルドのイベントをカレンダーグリッド上に配置して表示する
2. The カレンダーコンポーネント shall イベントを開始日時に基づいてグリッド上の適切な位置に配置する
3. While 日ビューまたは週ビューを表示中, the カレンダーコンポーネント shall イベントの継続時間に応じた高さでイベントブロックを表示する
4. While 月ビューを表示中, the カレンダーコンポーネント shall イベントを日付セル内にコンパクトなバー形式で表示する
5. When 同一時間帯に複数のイベントが存在する, the カレンダーコンポーネント shall イベントを横に並べるか重ねて表示し、全てのイベントにアクセス可能にする
6. When 月ビューの日付セルにイベントが表示しきれない場合, the カレンダーコンポーネント shall 残りのイベント数を「+N件」の形式で表示する
7. The カレンダーコンポーネント shall 各イベントブロックにイベント名を表示する

### Requirement 4: イベント詳細ポップオーバー
**Objective:** ユーザーとして、イベントをクリックして詳細情報をポップオーバーで確認したい。カレンダー画面から離れずに予定の詳細を把握できるようにしたい。

#### Acceptance Criteria
1. When ユーザーがカレンダー上のイベントをクリックする, the カレンダーコンポーネント shall イベント詳細のポップオーバーを表示する
2. The イベント詳細ポップオーバー shall イベント名、開始日時、終了日時、説明文を表示する
3. Where イベントに場所情報が設定されている, the イベント詳細ポップオーバー shall 場所情報を表示する
4. Where イベントにDiscordチャンネル情報が紐づいている, the イベント詳細ポップオーバー shall チャンネル名を表示する
5. When ユーザーがポップオーバー外をクリックする, the カレンダーコンポーネント shall ポップオーバーを閉じる
6. When ユーザーがEscキーを押下する, the カレンダーコンポーネント shall ポップオーバーを閉じる
7. The イベント詳細ポップオーバー shall クリックしたイベントの近くに表示され、画面外にはみ出さないように位置を調整する

### Requirement 5: ギルド選択との連携
**Objective:** ユーザーとして、ダッシュボードでギルドを選択したときに、そのギルドのイベントがカレンダーに反映されてほしい。

#### Acceptance Criteria
1. When ユーザーがギルドリストからギルドを選択する, the カレンダーコンポーネント shall 選択されたギルドのイベントを取得してカレンダーを更新する
2. While ギルドが選択されていない状態, the カレンダーコンポーネント shall イベントのない空のカレンダーグリッドを表示する
3. While イベントデータを読み込み中, the カレンダーコンポーネント shall ローディング状態を表示する
4. If イベントデータの取得に失敗した場合, the カレンダーコンポーネント shall エラーメッセージを表示し、再試行オプションを提供する

### Requirement 6: レスポンシブデザイン対応
**Objective:** ユーザーとして、デスクトップでもモバイルでも快適にカレンダーを閲覧したい。画面サイズに応じて最適化されたUIでスケジュールを確認できるようにしたい。

#### Acceptance Criteria
1. While デスクトップ画面幅（1024px以上）で表示中, the カレンダーコンポーネント shall 全てのビューモード（日/週/月）を完全な形式で表示する
2. While タブレット画面幅（768px以上1024px未満）で表示中, the カレンダーコンポーネント shall 週ビューのカラム幅を調整して表示する
3. While モバイル画面幅（768px未満）で表示中, the カレンダーコンポーネント shall 週ビューを簡略化するか、日ビューをデフォルトとして表示する
4. The カレンダーコンポーネント shall タッチデバイスでのタップ操作に対応する
5. The カレンダーコンポーネント shall 横スクロールなしで全コンテンツを閲覧可能にする

### Requirement 7: 今日の日付のハイライト
**Objective:** ユーザーとして、今日の日付がカレンダー上で明確に分かるようにしたい。現在日を基準に予定を把握しやすくしたい。

#### Acceptance Criteria
1. The カレンダーコンポーネント shall 今日の日付セルを視覚的にハイライトして表示する
2. While 月ビューを表示中, the カレンダーコンポーネント shall 今日の日付番号を強調表示する
3. While 週ビューを表示中, the カレンダーコンポーネント shall 今日の列ヘッダーを強調表示する
4. While 日ビューを表示中 and 今日を表示中, the カレンダーコンポーネント shall ヘッダーの日付表示を強調する

### Requirement 8: アクセシビリティ対応
**Objective:** ユーザーとして、スクリーンリーダーやキーボード操作でもカレンダーを利用したい。アクセシブルなUIで全てのユーザーが予定を確認できるようにしたい。

#### Acceptance Criteria
1. The カレンダーコンポーネント shall キーボードによるナビゲーション（矢印キーでの日付移動、Tabキーでのフォーカス移動）に対応する
2. The カレンダーコンポーネント shall 各UI要素に適切なARIAラベルを設定する
3. The カレンダーコンポーネント shall 日付セルに対してARIAグリッドロールを適用する
4. When イベントにフォーカスがある状態でEnterキーが押下される, the カレンダーコンポーネント shall イベント詳細ポップオーバーを表示する
5. The カレンダーコンポーネント shall 十分なカラーコントラスト比を確保して表示する

### Requirement 9: 終日イベントの表示
**Objective:** ユーザーとして、終日イベント（All-day event）が通常のイベントと区別して表示されることで、1日を通した予定を視覚的に把握したい。

#### Acceptance Criteria
1. The カレンダーコンポーネント shall 終日イベントを時間指定イベントと視覚的に区別して表示する
2. While 月ビューを表示中, the カレンダーコンポーネント shall 終日イベントを日付セルの上部にバー形式で表示する
3. While 週ビューを表示中, the カレンダーコンポーネント shall 終日イベントを時間軸グリッドの上部の専用エリアに表示する
4. While 日ビューを表示中, the カレンダーコンポーネント shall 終日イベントを時間軸グリッドの上部の専用エリアに表示する
5. The イベント詳細ポップオーバー shall 終日イベントの場合、時刻ではなく「終日」と表示する
6. When 同一日に複数の終日イベントが存在する, the カレンダーコンポーネント shall 終日イベントを縦に積み重ねて表示する
